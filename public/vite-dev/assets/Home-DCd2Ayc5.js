import{m as w,u as E}from"./globalConfig-ChqASJ8b.js";import{g as L}from"./utils.esm-DpfOb1Dc.js";import{c as $,n as R,b as V,I as F,u as z,r as B}from"./widget-DQCcDs7N.js";import{j as W}from"./sharedFrameEvents-0qZ2yOho.js";import{c as h,n as c,o as a,F as T,j as S,q as H,e as A,_ as k,s as b,p as o,a as _,g as C,t as v,z as I,H as g,aj as j,P as G}from"./_plugin-vue_export-helper-BDdLN-Za.js";import{T as P}from"./Thumbnail-BNAIzSQs.js";import{c as y,b as D}from"./index-BgTJAFtk.js";import{a as U}from"./Validators-Cc34aJUd.js";import"./vue-dompurify-html-CEAHYyWB.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-BtuGy7By.js";import"./constants-lVAyZKq6.js";import"./Icon-BkVHjXfD.js";import"./Branding-BIhdJV64.js";import"./module-DDGBE9SJ.js";import"./index-DN3rM4CW.js";const q={class:"flex"},Y={__name:"GroupedAvatars",props:{users:{type:Array,default:()=>[]},limit:{type:Number,default:4}},setup(e){const t=e,i=h(()=>t.users.slice(0,t.limit));return(u,r)=>(a(),c("div",q,[(a(!0),c(T,null,S(i.value,(n,s)=>(a(),c("span",{key:n.id,class:H([s?"ltr:-ml-4 rtl:-mr-4":"","inline-block rounded-full text-white shadow-solid"])},[A(P,{size:"36px",username:n.name,src:n.avatar_url,"has-border":""},null,8,["username","src"])],2))),128))]))}},J={name:"TeamAvailability",components:{GroupedAvatars:Y},mixins:[$,R,V],props:{availableAgents:{type:Array,default:()=>{}},hasConversation:{type:Boolean,default:!1}},emits:["startConversation"],computed:{...w({widgetColor:"appConfig/getWidgetColor"}),textColor(){return L(this.widgetColor)},agentAvatars(){return this.availableAgents.map(e=>({name:e.name,avatar:e.avatar_url,id:e.id}))},isOnline(){const{workingHoursEnabled:e}=this.channelConfig,t=this.availableAgents.length>0;return e?this.isInBetweenTheWorkingHours:t}},methods:{startConversation(){this.$emit("startConversation"),this.hasConversation||F.sendMessage({event:"onEvent",eventIdentifier:W,data:{hasConversation:!1}})}}},K={class:"flex flex-col gap-3 w-full shadow outline-1 outline outline-n-container rounded-xl bg-n-background dark:bg-n-solid-2 px-5 py-4"},Q={class:"flex items-center justify-between gap-2"},X={class:"flex flex-col gap-1"},Z={class:"font-medium text-n-slate-12"},ee={class:"text-n-slate-11"};function te(e,t,i,u,r,n){const s=b("GroupedAvatars");return a(),c("div",K,[o("div",Q,[o("div",X,[o("div",Z,v(n.isOnline?e.$t("TEAM_AVAILABILITY.ONLINE"):e.$t("TEAM_AVAILABILITY.OFFLINE")),1),o("div",ee,v(e.replyWaitMessage),1)]),n.isOnline?(a(),_(s,{key:0,users:i.availableAgents},null,8,["users"])):C("",!0)]),o("button",{class:"inline-flex items-center gap-1 font-medium text-n-slate-12",style:I({color:e.widgetColor}),onClick:t[0]||(t[0]=(...l)=>n.startConversation&&n.startConversation(...l))},[o("span",null,v(i.hasConversation?e.$t("CONTINUE_CONVERSATION"):e.$t("START_CONVERSATION")),1),t[1]||(t[1]=o("i",{class:"i-lucide-chevron-right size-5 mt-px"},null,-1))],4)])}const ne=k(J,[["render",te]]),se={class:"underline-offset-2 leading-6 ltr:text-left rtl:text-right text-base"},ae={__name:"ArticleListItem",props:{link:{type:String,default:""},title:{type:String,default:""}},emits:["selectArticle"],setup(e,{emit:t}){const i=e,u=t,r=()=>{u("selectArticle",i.link)};return(n,s)=>(a(),c("div",{class:"flex items-center justify-between rounded cursor-pointer text-n-slate-11 hover:text-n-slate-12 gap-2",role:"button",onClick:r},[o("button",se,v(e.title),1),s[0]||(s[0]=o("span",{class:"i-lucide-chevron-right text-base shrink-0"},null,-1))]))}},ie={class:"flex flex-col gap-3"},le={class:"font-medium text-n-slate-12"},oe={class:"flex flex-col gap-4"},re={__name:"ArticleBlock",props:{articles:{type:Array,default:()=>[]}},emits:["view","viewAll"],setup(e,{emit:t}){const i=e,u=t,r=y("appConfig/getWidgetColor"),n=h(()=>i.articles.slice(0,6)),s=l=>{u("view",l)};return(l,d)=>(a(),c("div",ie,[o("h3",le,v(l.$t("PORTAL.POPULAR_ARTICLES")),1),o("div",oe,[(a(!0),c(T,null,S(n.value,p=>(a(),_(ae,{key:p.slug,link:p.link,title:p.title,onSelectArticle:s},null,8,["link","title"]))),128))]),o("div",null,[o("button",{class:"font-medium tracking-wide inline-flex",style:I({color:g(r)}),onClick:d[0]||(d[0]=p=>l.$emit("viewAll"))},[o("span",null,v(l.$t("PORTAL.VIEW_ALL_ARTICLES")),1)],4)])]))}},ce={},ue={class:"py-4 space-y-4"};function de(e,t){return a(),c("div",ue,t[0]||(t[0]=[j('<div class="space-y-2 animate-pulse"><div class="h-6 bg-n-slate-5 dark:bg-n-alpha-black1 rounded w-2/5"></div></div><div class="space-y-2 animate-pulse"><div class="h-4 bg-n-slate-5 dark:bg-n-alpha-black1 rounded"></div><div class="h-4 bg-n-slate-5 dark:bg-n-alpha-black1 rounded"></div><div class="h-4 bg-n-slate-5 dark:bg-n-alpha-black1 rounded"></div></div><div class="space-y-2 animate-pulse"><div class="h-4 bg-n-slate-5 dark:bg-n-alpha-black1 rounded w-1/5"></div></div>',3)]))}const pe=k(ce,[["render",de]]),me=(e="",t=[])=>{if(!e||!Array.isArray(t)||!t.length)return null;const[i]=e.split("_");return[e,i,t.find(r=>r.startsWith(`${i}_`))].find(r=>r&&t.includes(r))??null},ve={key:0,class:"w-full shadow outline-1 outline outline-n-container rounded-xl bg-n-background dark:bg-n-solid-2 px-5 py-4"},ge={key:1,class:"hidden"},he={__name:"ArticleContainer",setup(e){const t=D(),i=U(),u=E(),{prefersDarkMode:r}=z(),n=h(()=>window.chatwootWebChannel.portal),s=y("article/popularArticles"),l=y("article/uiFlags"),d=h(()=>{const{locale:m}=u,{allowed_locales:f}=n.value.config;return me(m.value,f)}),p=()=>{n.value&&!s.value.length&&t.dispatch("article/fetch",{slug:n.value.slug,locale:d.value})},x=m=>{const f=new URLSearchParams({show_plain_layout:"true",theme:r.value?"dark":"light",...d.value&&{locale:d.value}}),N=`${m}?${f.toString()}`;i.push({name:"article-viewer",query:{link:N}})},O=()=>{const{portal:{slug:m}}=window.chatwootWebChannel;x(`/hc/${m}/${d.value}`)},M=h(()=>!l.value.isFetching&&!l.value.isError&&!!s.value.length&&!!d.value);return G(()=>p()),(m,f)=>n.value&&(g(l).isFetching||g(s).length)?(a(),c("div",ve,[M.value?(a(),_(re,{key:0,articles:g(s),onView:x,onViewAll:O},null,8,["articles"])):C("",!0),g(l).isFetching?(a(),_(pe,{key:1})):C("",!0)])):(a(),c("div",ge))}},fe={name:"Home",components:{ArticleContainer:he,TeamAvailability:ne},mixins:[$,B],computed:{...w({availableAgents:"agent/availableAgents",conversationSize:"conversation/getConversationSize",unreadMessageCount:"conversation/getUnreadMessageCount"})},methods:{startConversation(){return this.preChatFormEnabled&&!this.conversationSize?this.replaceRoute("prechat-form"):this.replaceRoute("messages")}}},_e={class:"z-50 flex flex-col justify-end flex-1 w-full p-4 gap-4"};function Ae(e,t,i,u,r,n){const s=b("TeamAvailability"),l=b("ArticleContainer");return a(),c("div",_e,[A(s,{"available-agents":e.availableAgents,"has-conversation":!!e.conversationSize,"unread-count":e.unreadMessageCount,onStartConversation:n.startConversation},null,8,["available-agents","has-conversation","unread-count","onStartConversation"]),A(l)])}const Ve=k(fe,[["render",Ae]]);export{Ve as default};
